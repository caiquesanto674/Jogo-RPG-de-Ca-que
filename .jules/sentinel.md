## 2024-07-22 - Unsalted Hash in Confirmation Protocol
**Vulnerability:** The `ProtocoloConfirmacao.gerar` method used `hashlib.sha256` on a predictable string containing action, agent, level, and a timestamp. While the timestamp provides some uniqueness, the absence of a secret, random salt makes the hash vulnerable to pre-computation (rainbow tables) and doesn't fully protect against sophisticated replay attacks or collisions if the timestamp resolution is not guaranteed to be unique.
**Learning:** A timestamp alone is insufficient for securing hashes. A secret, unpredictable salt is necessary to protect against dictionary and rainbow table attacks, ensuring the same input does not always produce the same hash across different contexts.
**Prevention:** All security-critical hashing functions must incorporate a cryptographically secure salt. This salt should be unique and stored securely, separate from the hash values if possible. For this application, generating a salt at runtime for the session is a sufficient mitigation.
